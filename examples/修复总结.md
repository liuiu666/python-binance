# æœŸè´§WebSocketç«¯ç‚¹ä¿®å¤æ€»ç»“

## é—®é¢˜æè¿°
æ‚¨çš„ `binancedata.py` æ–‡ä»¶ä¹‹å‰ä½¿ç”¨çš„æ˜¯æ™®é€šçš„ `DepthCacheManager`ï¼Œå®ƒè¿æ¥åˆ°ç°è´§WebSocketç«¯ç‚¹ `wss://stream.binance.com:9443/`ï¼Œè€Œä¸æ˜¯æœŸè´§åˆçº¦åº”è¯¥ä½¿ç”¨çš„ç«¯ç‚¹ `wss://fstream.binance.com/`ã€‚

## é—®é¢˜æ ¹æº
1. **é”™è¯¯çš„DepthCacheManagerç±»å‹**: ä½¿ç”¨äº† `DepthCacheManager` è€Œä¸æ˜¯ `FuturesDepthCacheManager`
2. **é”™è¯¯çš„WebSocketç«¯ç‚¹**: è¿æ¥åˆ°ç°è´§ç«¯ç‚¹è€Œä¸æ˜¯æœŸè´§ç«¯ç‚¹
3. **å‚æ•°ä¸å…¼å®¹**: `FuturesDepthCacheManager` ä¸æ”¯æŒ `ws_interval` å‚æ•°

## ä¿®å¤å†…å®¹

### 1. æ›´æ”¹å¯¼å…¥è¯­å¥
```python
# ä¿®å¤å‰
from binance.ws.depthcache import DepthCacheManager

# ä¿®å¤å  
from binance.ws.depthcache import FuturesDepthCacheManager
```

### 2. æ›´æ”¹DepthCacheManagerç±»å‹
```python
# ä¿®å¤å‰
self.depth_cache_manager = DepthCacheManager(
    client=self.client,
    symbol=self.symbol,
    bm=self.bm,
    limit=1000,
    refresh_interval=30*60,
    ws_interval=100  # è¿™ä¸ªå‚æ•°ä¸è¢«æ”¯æŒ
)

# ä¿®å¤å
self.depth_cache_manager = FuturesDepthCacheManager(
    client=self.client,
    symbol=self.symbol,
    bm=self.bm,
    limit=1000,
    refresh_interval=30*60  # ç§»é™¤äº†ws_intervalå‚æ•°
)
```

## WebSocketç«¯ç‚¹å¯¹æ¯”

| ç±»å‹ | ç±»å | WebSocketç«¯ç‚¹ | ç”¨é€” |
|------|------|---------------|------|
| ç°è´§ | `DepthCacheManager` | `wss://stream.binance.com:9443/` | ç°è´§äº¤æ˜“å¯¹ |
| æœŸè´§ | `FuturesDepthCacheManager` | `wss://fstream.binance.com/` | USD-MæœŸè´§åˆçº¦ |
| å¸æœ¬ä½æœŸè´§ | `FuturesDepthCacheManager` | `wss://dstream.binance.com/` | Coin-MæœŸè´§åˆçº¦ |

## éªŒè¯ç»“æœ
âœ… **è¿æ¥æˆåŠŸ**: ç¨‹åºç°åœ¨èƒ½å¤ŸæˆåŠŸè¿æ¥åˆ°æ­£ç¡®çš„æœŸè´§WebSocketç«¯ç‚¹  
âœ… **ç«¯ç‚¹æ­£ç¡®**: ä½¿ç”¨ `wss://fstream.binance.com/` ç«¯ç‚¹  
âœ… **æ•°æ®æµæ­£å¸¸**: WebSocketå¢é‡æ›´æ–°å·²å»ºç«‹  
âœ… **ä»£ç†é…ç½®**: é€šè¿‡ `https_proxy` å‚æ•°æ­£å¸¸å·¥ä½œ  

## æµ‹è¯•è¾“å‡º
```
ğŸ“¡ å¼€å§‹ç›‘å¬ BTCUSDT è®¢å•ç°¿æ•°æ®...
ğŸ“¥ æ­£åœ¨è·å–åˆå§‹è®¢å•ç°¿å¿«ç…§...
âœ… æ·±åº¦ç¼“å­˜ç®¡ç†å™¨å¯åŠ¨æˆåŠŸ
âœ… åˆå§‹è®¢å•ç°¿å¿«ç…§å·²è·å–
âœ… WebSocketå¢é‡æ›´æ–°å·²å»ºç«‹
ğŸ¯ å¼€å§‹å®æ—¶æ•°æ®æµ...
```

## é‡è¦è¯´æ˜
- **æœŸè´§åˆçº¦å¿…é¡»ä½¿ç”¨ `FuturesDepthCacheManager`** æ‰èƒ½è¿æ¥åˆ°æ­£ç¡®çš„WebSocketç«¯ç‚¹
- **`FuturesDepthCacheManager` ä¸æ”¯æŒ `ws_interval` å‚æ•°**ï¼Œè¿™æ˜¯åŸºç±»çš„é™åˆ¶
- **ä»£ç†é…ç½®é€šè¿‡ `https_proxy` å‚æ•°æ­£å¸¸å·¥ä½œ**ï¼Œä½†WebSocketä»£ç†æ”¯æŒå¯èƒ½æœ‰é™åˆ¶
- **ç°åœ¨çš„é…ç½®æ˜¯æ­£ç¡®çš„**ï¼Œé€‚ç”¨äºUSD-MæœŸè´§åˆçº¦çš„å®æ—¶è®¢å•ç°¿æ•°æ®æ”¶é›†

## æ–‡ä»¶ä¿®æ”¹
- âœ… `binancedata.py` - å·²ä¿®å¤æœŸè´§WebSocketç«¯ç‚¹é…ç½®
- âœ… æµ‹è¯•è„šæœ¬å·²éªŒè¯ä¿®å¤æ•ˆæœ
- âœ… ç¨‹åºç°åœ¨ä½¿ç”¨æ­£ç¡®çš„æœŸè´§WebSocketç«¯ç‚¹